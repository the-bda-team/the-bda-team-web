module Jekyll
  module UnicodeToLatexFilter
    MAP = {
      # Latin-1 Supplement (U+00C0 to U+00FF)
      "À" => "{\\`A}", "Á" => "{\\'A}", "Â" => "{\\^A}", "Ã" => "{\\~A}", "Ä" => "{\\\"A}", "Å" => "{\\AA}",
      "Æ" => "{\\AE}", "Ç" => "{\\c{C}}", "È" => "{\\`E}", "É" => "{\\'E}", "Ê" => "{\\^E}", "Ë" => "{\\\"E}",
      "Ì" => "{\\`I}", "Í" => "{\\'I}", "Î" => "{\\^I}", "Ï" => "{\\\"I}", "Ð" => "{\\DH}", "Ñ" => "{\\~N}",
      "Ò" => "{\\`O}", "Ó" => "{\\'O}", "Ô" => "{\\^O}", "Õ" => "{\\~O}", "Ö" => "{\\\"O}", "Ø" => "{\\O}",
      "Ù" => "{\\`U}", "Ú" => "{\\'U}", "Û" => "{\\^U}", "Ü" => "{\\\"U}", "Ý" => "{\\'Y}", "Þ" => "{\\TH}",
      "ß" => "{\\ss}",

      "à" => "{\\`a}", "á" => "{\\'a}", "â" => "{\\^a}", "ã" => "{\\~a}", "ä" => "{\\\"a}", "å" => "{\\aa}",
      "æ" => "{\\ae}", "ç" => "{\\c{c}}", "è" => "{\\`e}", "é" => "{\\'e}", "ê" => "{\\^e}", "ë" => "{\\\"e}",
      "ì" => "{\\`i}", "í" => "{\\'i}", "î" => "{\\^i}", "ï" => "{\\\"i}", "ð" => "{\\dh}", "ñ" => "{\\~n}",
      "ò" => "{\\`o}", "ó" => "{\\'o}", "ô" => "{\\^o}", "õ" => "{\\~o}", "ö" => "{\\\"o}", "ø" => "{\\o}",
      "ù" => "{\\`u}", "ú" => "{\\'u}", "û" => "{\\^u}", "ü" => "{\\\"u}", "ý" => "{\\'y}", "þ" => "{\\th}",
      "ÿ" => "{\\\"y}",

      # Latin Extended-A (U+0100 to U+017F) - common letters with accents
      "Ā" => "{\\=A}", "ā" => "{\\=a}", "Ă" => "{\\u{A}}", "ă" => "{\\u{a}}", "Ą" => "{\\k{A}}", "ą" => "{\\k{a}}",
      "Ć" => "{\\'C}", "ć" => "{\\'c}", "Ĉ" => "{\\^C}", "ĉ" => "{\\^c}", "Ċ" => "{\\.C}", "ċ" => "{\\.c}",
      "Č" => "{\\v{C}}", "č" => "{\\v{c}}", "Ď" => "{\\v{D}}", "ď" => "{\\v{d}}", "Đ" => "{\\DJ}", "đ" => "{\\dj}",
      "Ē" => "{\\=E}", "ē" => "{\\=e}", "Ĕ" => "{\\u{E}}", "ĕ" => "{\\u{e}}", "Ė" => "{\\.E}", "ė" => "{\\.e}",
      "Ę" => "{\\k{E}}", "ę" => "{\\k{e}}", "Ě" => "{\\v{E}}", "ě" => "{\\v{e}}",
      "Ĝ" => "{\\^G}", "ĝ" => "{\\^g}", "Ğ" => "{\\u{G}}", "ğ" => "{\\u{g}}", "Ġ" => "{\\.G}", "ġ" => "{\\.g}",
      "Ģ" => "{\\c{G}}", "ģ" => "{\\c{g}}",
      "Ĥ" => "{\\^H}", "ĥ" => "{\\^h}", "Ħ" => "{\\H{H}}", "ħ" => "{\\H{h}}",
      "Ĩ" => "{\\~I}", "ĩ" => "{\\~i}", "Ī" => "{\\=I}", "ī" => "{\\=i}", "Ĭ" => "{\\u{I}}", "ĭ" => "{\\u{i}}",
      "Į" => "{\\k{I}}", "į" => "{\\k{i}}", "İ" => "{\\.I}", "ı" => "{\\i}", "Ĳ" => "{\\IJ}", "ĳ" => "{\\ij}",
      "Ĵ" => "{\\^J}", "ĵ" => "{\\^j}",
      "Ķ" => "{\\c{K}}", "ķ" => "{\\c{k}}", "ĸ" => "{\\ae}",  # Lithuanian / Icelandic
      "Ĺ" => "{\\'L}", "ĺ" => "{\\'l}", "Ļ" => "{\\c{L}}", "ļ" => "{\\c{l}}", "Ľ" => "{\\v{L}}", "ľ" => "{\\v{l}}",
      "Ł" => "{\\L}", "ł" => "{\\l}",
      "Ń" => "{\\'N}", "ń" => "{\\'n}", "Ņ" => "{\\c{N}}", "ņ" => "{\\c{n}}", "Ň" => "{\\v{N}}", "ň" => "{\\v{n}}",
      "Ō" => "{\\=O}", "ō" => "{\\=o}", "Ŏ" => "{\\u{O}}", "ŏ" => "{\\u{o}}", "Ő" => "{\\H{O}}", "ő" => "{\\H{o}}",
      "Œ" => "{\\OE}", "œ" => "{\\oe}", "Ŕ" => "{\\'R}", "ŕ" => "{\\'r}", "Ŗ" => "{\\c{R}}", "ŗ" => "{\\c{r}}",
      "Ř" => "{\\v{R}}", "ř" => "{\\v{r}}",
      "Ś" => "{\\'S}", "ś" => "{\\'s}", "Ŝ" => "{\\^S}", "ŝ" => "{\\^s}", "Ş" => "{\\c{S}}", "ş" => "{\\c{s}}",
      "Š" => "{\\v{S}}", "š" => "{\\v{s}}",
      "Ţ" => "{\\c{T}}", "ţ" => "{\\c{t}}", "Ť" => "{\\v{T}}", "ť" => "{\\v{t}}", "Ŧ" => "{\\DJ}", "ŧ" => "{\\dj}",
      "Ũ" => "{\\~U}", "ũ" => "{\\~u}", "Ū" => "{\\=U}", "ū" => "{\\=u}", "Ŭ" => "{\\u{U}}", "ŭ" => "{\\u{u}}",
      "Ů" => "{\\r{U}}", "ů" => "{\\r{u}}", "Ű" => "{\\H{U}}", "ű" => "{\\H{u}}", "Ų" => "{\\k{U}}", "ų" => "{\\k{u}}",
      "Ŵ" => "{\\^W}", "ŵ" => "{\\^w}",
      "Ŷ" => "{\\^Y}", "ŷ" => "{\\^y}", "Ÿ" => "{\\\"Y}",
      "Ź" => "{\\'Z}", "ź" => "{\\'z}", "Ż" => "{\\.Z}", "ż" => "{\\.z}", "Ž" => "{\\v{Z}}", "ž" => "{\\v{z}}"
    }.freeze

    def unicode_to_latex(input)
      return input unless input.is_a?(String)
      input.each_char.map { |c| MAP.fetch(c, c) }.join
    end
  end
end

Liquid::Template.register_filter(Jekyll::UnicodeToLatexFilter)
